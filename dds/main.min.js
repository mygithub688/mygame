var GameOver=function(t){function a(){a.super(this),this.restartBtn.on(Laya.Event.CLICK,this,this.restartGame)}Laya.class(a,"GameOver",t);var e=a.prototype;return e.restartGame=function(){this.removeSelf(),LayaSample.game.removeSelf(),Laya.stage.addChild(LayaSample.gameStart)},e.setScoreUI=function(t){this.data={},this.temp=t;for(var a=9;a>=0;a--)this.data["item"+a]={index:Math.floor(this.temp%10)},this.temp/=10;this.scoreNums.dataSource=this.data},a}(ui.GameOverUI),GameStart=function(t){function a(){a.super(this),this.startBtn.on(Laya.Event.CLICK,this,this.onStartGame)}return Laya.class(a,"GameStart",t),a.prototype.onStartGame=function(){this.removeSelf(),LayaSample.game||(LayaSample.game=new Game),LayaSample.game.gameStart(),Laya.stage.addChild(LayaSample.game)},a}(ui.GameStartUI),Hammer=function(t){function a(){a.super(this)}Laya.class(a,"Hammer",t);var e=a.prototype;return e.start=function(){Laya.Mouse.hide(),Laya.stage.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),Laya.stage.on(Laya.Event.MOUSE_MOVE,this,this.onMouseMove),this.onMouseMove()},e.end=function(){Laya.Mouse.show(),Laya.stage.off(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),Laya.stage.off(Laya.Event.MOUSE_MOVE,this,this.onMouseMove)},e.onMouseDown=function(){this.hit.play(0,!1)},e.onMouseMove=function(){this.pos(Laya.stage.mouseX-this.width/2,Laya.stage.mouseY-this.height/3)},a}(ui.HammerUI),Mole=function(){function t(t,a,e,i,s){this.normalState=t,this.hitState=a,this.downY=e,this.upY=this.normalState.y,this.hitCallBackHd=i,this.scoreImg=s,this.scoreY=this.scoreImg.y,this.normalState.on(Laya.Event.CLICK,this,this.hit),this.reset()}var a=t.prototype;return a.reset=function(){this.normalState.visible=!1,this.hitState.visible=!1,this.isVctive=!1,this.isShow=!1,this.isHit=!1,this.scoreImg.visible=!1},a.show=function(){this.isVctive||(this.isVctive=!0,this.isShow=!0,this.type=Math.random()<.3?1:2,this.normalState.skin="comp/mouse_normal_"+this.type+".png",this.hitState.skin="comp/mouse_hit_"+this.type+".png",this.scoreImg.skin="comp/score_"+this.type+".png",this.normalState.y=this.downY,this.normalState.visible=!0,this.hitState.visible=!1,Laya.Tween.to(this.normalState,{y:this.upY},500,Laya.Ease.backOut,Laya.Handler.create(this,this.showComplete)))},a.showComplete=function(){this.isShow&&!this.isHit&&Laya.timer.once(2e3,this,this.hide)},a.hide=function(){this.isShow&&!this.isHit&&(this.isShow=!1,Laya.Tween.to(this.normalState,{y:this.downY},300,Laya.Ease.backIn,Laya.Handler.create(this,this.reset)))},a.hit=function(){this.isShow&&!this.isHit&&(this.isShow=!1,this.isHit=!0,Laya.timer.clear(this,this.hide),this.normalState.visible=!1,this.hitState.visible=!0,this.hitCallBackHd.runWith(this.type),Laya.timer.once(500,this,this.reset),this.showScore())},a.showScore=function(){this.scoreImg.y=this.scoreY+30,this.scoreImg.scale(0,0),this.scoreImg.visible=!0,Laya.Tween.to(this.scoreImg,{y:this.scoreY,scaleX:1,scaleY:1},300,Laya.Ease.backOut)},t}(),Game=function(t){function a(){this.moles=new Array,this.moleNum=9,a.super(this),this.hitCallBackHd=Laya.Handler.create(this,this.setScore,null,!1);for(var t=0;t<this.moleNum;t++)this.box=this.getChildByName("item"+t),this.mole=new Mole(this.box.getChildByName("normal"),this.box.getChildByName("hit"),21,this.hitCallBackHd,this.box.getChildByName("scoreimg")),this.moles.push(this.mole);this.hammer=new Hammer,this.addChild(this.hammer),this.hammer.visible=!1}Laya.class(a,"Game",t);var e=a.prototype;return e.isShow=function(){if(this.timeBar.value-=1/15,this.timeBar.value<=0)return void this.gameOver();this.index=Math.floor(Math.random()*this.moleNum),this.moles[this.index].show()},e.gameOver=function(){Laya.timer.clear(this,this.isShow),this.hammer.visible=!1,this.hammer.end(),LayaSample.gameOver||(LayaSample.gameOver=new GameOver),LayaSample.gameOver.centerX=0,LayaSample.gameOver.centerY=40,LayaSample.gameOver.setScoreUI(this.score),Laya.stage.addChild(LayaSample.gameOver)},e.setScore=function(t){this.score+=1==t?-100:100,this.timeBar.value+=1==t?-.1:.1,this.score<=0&&(this.score=0),this.updateScoreUI()},e.updateScoreUI=function(){this.data={},this.temp=this.score;for(var t=9;t>=0;t--)this.data["item"+t]={index:Math.floor(this.temp%10)},this.temp/=10;this.scoreNums.dataSource=this.data},e.gameStart=function(){this.timeBar.value=1,this.score=0,this.updateScoreUI(),this.hammer.visible=!0,this.hammer.start(),Laya.timer.loop(1e3,this,this.isShow)},a}(ui.GameUI);!function(){function t(){LayaSample.gameStart=new GameStart,Laya.stage.addChild(LayaSample.gameStart)}!function(a){Laya.init(800,600),Laya.stage.scaleMode=Laya.Stage.SCALE_NOSCALE,Laya.stage.alignH=Laya.Stage.ALIGN_CENTER,Laya.stage.alignV=Laya.Stage.ALIGN_MIDDLE,Laya.stage.screenMode=Laya.Stage.SCREEN_HORIZONTAL,Laya.stage.bgColor="#ffffff",Laya.loader.load("res/atlas/comp.json",Laya.Handler.create(this,t),null,Laya.Loader.ATLAS)}()}(window.LayaSample||(window.LayaSample={}));